import{j as e,c as p,f as he,r,p as V,e as pe,a as xe,b as _,u as W,d as q,g as ne,h as ge,i as ye,k as P,l as je,m as K,n as ve,o as U,q as be,s as we,t as Ne,v as Ce,w as Se,x as Z,y as ke,z as $e,A as Le,B as Me,N as Re,O as De,R as Te,C as H,D as Ie,E as Ee,H as ze}from"./vendor-d2bb59f3.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const l of c)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function t(c){const l={};return c.integrity&&(l.integrity=c.integrity),c.referrerPolicy&&(l.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?l.credentials="include":c.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(c){if(c.ep)return;c.ep=!0;const l=t(c);fetch(c.href,l)}})();function te(n){const{title:s,children:t,className:o,style:c}=n;return e.jsxs("header",{className:p("header",o),style:c,children:[e.jsx("h1",{className:"md:text-xl",children:s}),e.jsx("div",{className:"flex flex-auto items-center justify-end",children:t})]})}function A(n){const{type:s,size:t=14,className:o,style:c}=n,l=p("lightsocks-iconfont",`icon-${s}`,o),a={fontSize:t,...c},d={...n,className:l,style:a};return e.jsx("i",{...d})}function E(){}function N(n){const s=["B","KiB","MiB","GiB","TiB"],t=Math.floor(Math.log(n||1)/Math.log(1024));return`${he(n/Math.pow(1024,t),2).toFixed(2)} ${(s==null?void 0:s[t])??""}`}const Y=r.forwardRef((n,s)=>{const{className:t,style:o,children:c}=n;return e.jsx("div",{className:p("card",t),style:o,ref:s,children:c})});const Oe={SideBar:{Info:"Info Version",Overview:"Overview",Logs:"Logs",Connections:"Connections"},Logs:{title:"Logs",levelLabel:"Log level"},Connections:{title:"Connections",keepClosed:"Keep closed connections",total:{text:"total",upload:"upload",download:"download"},closeAll:{title:"Warning",content:"This would close all connections"},filter:{all:"All"},columns:{client:"Client",network:"Network",type:"Type",speed:"Speed",upload:"Upload",download:"Download",time:"Time"},info:{title:"Connection",id:"ID",client:"Client",source:"Source",target:"Target",upload:"Up",download:"Down",network:"Network",type:"Type",status:"Status",opening:"Open",closed:"Closed",closeConnection:"Close"}},Modal:{ok:"Ok",cancel:"Cancel"}},Ue={SideBar:{Overview:"总览",Info:"版本信息",Logs:"日志",Connections:"连接"},Logs:{title:"日志",levelLabel:"日志等级"},Connections:{title:"连接",keepClosed:"保留关闭连接",total:{text:"总量",upload:"上传",download:"下载"},closeAll:{title:"警告",content:"将会关闭所有连接"},filter:{all:"全部"},columns:{client:"客户端",network:"网络",type:"类型",speed:"速率",upload:"上传",download:"下载",time:"连接时间"},info:{title:"连接信息",id:"ID",client:"客户端",source:"来源",target:"目的",upload:"上传",download:"下载",network:"网络",type:"类型",status:"状态",opening:"连接中",closed:"已关闭",closeConnection:"关闭连接"}},Modal:{ok:"确 定",cancel:"取 消"}},se={en_US:Oe,zh_CN:Ue},Ae=Object.keys(se);function Be(){for(const n of window.navigator.languages){if(n.includes("zh"))return"zh_CN";if(n.includes("us"))return"en_US"}return"en_US"}function He(n){return r.useMemo(()=>{function t(o,c){if(typeof o=="string")n(l=>{const a=o,d=c;l[a]=d});else if(typeof o=="function"){const l=o;n(a=>l(a))}else typeof o=="object"&&n(l=>V(l,a=>{const d=o;for(const f of Object.keys(d)){const y=f;a[y]=d[y]}}))}return t},[n])}class oe{constructor(s){this.EE=new pe,this.innerBuffer=[],this.url="",this.connection=null,this.config=Object.assign({bufferLength:0,retryInterval:5e3},s)}connectWebsocket(){if(!this.url)return;const s=new URL(this.url);this.connection=new WebSocket(s.toString()),this.connection.addEventListener("message",t=>{const o=JSON.parse(t.data);this.EE.emit("data",[o]),this.config.bufferLength>0&&(this.innerBuffer.push(o),this.innerBuffer.length>this.config.bufferLength&&this.innerBuffer.splice(0,this.innerBuffer.length-this.config.bufferLength))}),this.connection.addEventListener("error",t=>{var o;this.EE.emit("error",t),(o=this.connection)==null||o.close(),setTimeout(this.connectWebsocket,this.config.retryInterval)})}connect(s){var t;this.url===s&&this.connection||(this.url=s,(t=this.connection)==null||t.close(),this.connectWebsocket())}subscribe(s,t){this.EE.addListener(s,t)}unsubscribe(s,t){this.EE.removeListener(s,t)}buffer(){return this.innerBuffer.slice()}destory(){var s;this.EE.removeAllListeners(),(s=this.connection)==null||s.close(),this.connection=null}}class Pe{constructor(s,t){this.axiosClient=xe.create({baseURL:s,headers:t?{Authorization:`Bearer ${t}`}:{}})}async closeAllConnections(){return await this.axiosClient.delete("api/connections")}async closeConnection(s){return await this.axiosClient.delete(`api/connections/${s}`)}async getConnections(){return await this.axiosClient.get("api/connections")}async getVersion(){return await this.axiosClient.get("api/version")}}function G(){const n=location.hostname,s=location.port,t=location.protocol,o=W(),l=new URLSearchParams(o.search).get("secret")??"";return{hostname:n,port:s,secret:l,protocol:t}}const Fe=_({key:"",instance:null});function Ve(){const{hostname:n,port:s,secret:t,protocol:o}=G(),[c,l]=q(Fe),a=`${o}//${n}:${s}?secret=${t}`;if(c.key===a)return c.instance;const d=new Pe(`${o}//${n}:${s}`,t);return l({key:a,instance:d}),d}_(!0);const _e=ne("language",void 0);function D(){const[n,s]=q(_e),t=r.useMemo(()=>n??Be(),[n]),o=r.useCallback(function(c){function l(a){return je(se[t][c],a)}return{t:l}},[t]);return{lang:t,locales:Ae,setLang:s,translation:o}}const We=ne("profile",{logLevel:""});function ce(){const[n,s]=q(We),t=r.useCallback(o=>{s(V(n,o))},[n,s]);return{data:n,set:He(t)}}const qe=_(new oe({bufferLength:200}));function le(){const n=G(),{data:{logLevel:s}}=ce(),t=ge(qe),o=s,c=ye(`${n.protocol}//${n.hostname}:${n.port}/api/logs?level=${o}&secret=${encodeURIComponent(n.secret)}`),l=P(n);return r.useEffect(()=>{if(o){const a=l.current,f=`${a.protocol==="http:"?"ws:":"wss:"}//${a.hostname}:${a.port}/api/logs?level=${o}&token=${encodeURIComponent(a.secret)}`;t.connect(f)}},[l,t,o,c]),t}function Ke(){const n=G(),s=r.useRef(new oe({bufferLength:200})),o=`${n.protocol==="http:"?"ws:":"wss:"}//${n.hostname}:${n.port}/api/connections?token=${encodeURIComponent(n.secret)}`;return r.useEffect(()=>{s.current.connect(o)},[o]),s.current}function Ye(n){const{value:s,options:t,onSelect:o,disabled:c,className:l,style:a}=n,d=r.useRef(document.createElement("div")),f=r.useRef(null),[y,j]=r.useState(!1),[h,v]=r.useState({});r.useLayoutEffect(()=>{const x=d.current;return document.body.appendChild(x),()=>{document.body.removeChild(x)}},[]);function b(){if(!c){if(!y){const x=f.current.getBoundingClientRect();v({top:Math.floor(x.top+x.height)+6,left:Math.floor(x.left)-10})}j(!y)}}const C=r.useMemo(()=>t.find(x=>x.value===s),[s,t]),M=e.jsx("div",{className:p("select-list",{"select-list-show":y}),style:h,children:e.jsx("ul",{className:"list",children:t.map(x=>e.jsx(Ge,{className:p({selected:x.value===s}),onClick:k=>{o==null||o(x.value,k),j(!1)},disabled:x.disabled,value:x.value,children:x.label},x.key??x.value))})});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:p("select",{disabled:c},l),style:a,ref:f,onClick:b,children:[e.jsx("span",{className:"select-none",children:C==null?void 0:C.label}),e.jsx(A,{type:"triangle-down"})]}),K.createPortal(M,d.current)]})}function Ge(n){const{className:s,style:t,disabled:o=!1,children:c,onClick:l=E}=n,a=p("option",{disabled:o},s);return e.jsx("li",{className:a,style:t,onClick:l,children:c})}function Je(n){const{show:s=!0,title:t="Modal",size:o="small",footer:c=!0,onOk:l=E,onClose:a=E,bodyClassName:d,bodyStyle:f,className:y,footerExtra:j,style:h,children:v}=n,{translation:b}=D(),{t:C}=b("Modal"),M=r.useRef(document.createElement("div")),x=r.useRef(null);r.useLayoutEffect(()=>{const $=M.current;return document.body.appendChild($),()=>{document.body.removeChild($)}},[]);function k($){$.target===x.current&&a()}const z=e.jsx("div",{className:p("modal-mask",{"modal-show":s}),ref:x,onMouseDown:k,children:e.jsxs("div",{className:p("modal",`modal-${o}`,y),style:h,children:[e.jsx("div",{className:"modal-title",children:t}),e.jsx("div",{className:p("modal-body",d),style:f,children:v}),c&&e.jsxs("div",{className:"flex items-center justify-between",children:[j,e.jsxs("div",{className:"flex flex-1 justify-end space-x-3",children:[e.jsx(F,{onClick:()=>a(),children:C("cancel")}),e.jsx(F,{type:"primary",onClick:()=>l(),children:C("ok")})]})]})]})});return K.createPortal(z,M.current)}function F(n){const{type:s="normal",onClick:t=E,children:o,className:c,style:l,disabled:a}=n,d=p("button",`button-${s}`,c,{"button-disabled":a});return e.jsx("button",{className:d,style:l,onClick:t,disabled:a,children:o})}function ee(n){const[s,t]=ve(n),o=r.useMemo(()=>{function c(l,a){typeof l=="string"?t(d=>{const f=l,y=a;d[f]=y}):typeof l=="function"?t(l):typeof l=="object"&&t(d=>{const f=l;for(const y of Object.keys(f)){const j=y;d[j]=f[j]}})}return c},[t]);return[s,o]}function Qe(n=!1){const[s,t]=r.useState(n);function o(){t(!1)}function c(){t(!0)}return{visible:s,hide:o,show:c}}function Xe(n){const{className:s,checked:t=!1,onChange:o=E}=n,c=p("checkbox",{checked:t},s);function l(){o(!t)}return e.jsxs("div",{className:c,onClick:l,children:[e.jsx(A,{className:"checkbox-icon",type:"check",size:18}),e.jsx("div",{children:n.children})]})}function Ze(n){const s=p("spinner",n.className);return e.jsxs("div",{className:s,children:[e.jsx("div",{className:"spinner-circle",children:e.jsx("div",{className:"spinner-inner"})}),e.jsx("div",{className:"spinner-circle",children:e.jsx("div",{className:"spinner-inner"})}),e.jsx("div",{className:"spinner-circle",children:e.jsx("div",{className:"spinner-inner"})}),e.jsx("div",{className:"spinner-circle",children:e.jsx("div",{className:"spinner-inner"})}),e.jsx("div",{className:"spinner-circle",children:e.jsx("div",{className:"spinner-inner"})})]})}function en(n){const s=p("loading","visible",n.className);return n.visible?e.jsx("div",{className:s,children:e.jsx(Ze,{className:n.spinnerClassName})}):null}function nn(n){var c;const s=r.useRef(document.createElement("div"));r.useLayoutEffect(()=>{const l=s.current;return document.body.appendChild(l),()=>{document.body.removeChild(l)}},[]);const t="absolute h-full right-0 transition-transform transform duration-100 pointer-events-auto",o=e.jsx("div",{className:p(n.className,"z-9999 pointer-events-none absolute inset-0"),children:e.jsx(Y,{className:p(t,n.bodyClassName,{"translate-x-0":n.visible,"translate-x-full":!n.visible}),style:{width:n.width??400},children:n.children})});return K.createPortal(o,((c=n.containerRef)==null?void 0:c.current)??s.current)}U.extend(be);function tn(n,s){const t=s==="en_US"?"en":"zh-cn";return U(n).locale(t).from(U())}function sn(n){var o,c,l,a,d;const{translation:s}=D(),t=r.useMemo(()=>s("Connections").t,[s]);return e.jsxs("div",{className:p(n.className,"flex flex-col overflow-y-auto text-sm"),children:[e.jsxs("div",{className:"my-3 flex",children:[e.jsx("span",{className:"w-20 font-bold",children:t("info.id")}),e.jsx("span",{className:"font-mono",children:n.connection.ID})]}),e.jsxs("div",{className:"my-3 flex justify-between",children:[e.jsxs("div",{className:"flex flex-1",children:[e.jsx("span",{className:"w-20 font-bold",children:t("info.network")}),e.jsx("span",{className:"font-mono",children:(o=n.connection.Metadata)==null?void 0:o.Network.toUpperCase()})]}),e.jsxs("div",{className:"flex flex-1",children:[e.jsx("span",{className:"w-20 font-bold",children:t("info.type")}),e.jsx("span",{className:"font-mono",children:(c=n.connection.Metadata)==null?void 0:c.Type})]})]}),e.jsxs("div",{className:"my-3 flex",children:[e.jsx("span",{className:"w-20 font-bold",children:t("info.client")}),e.jsx("span",{className:"flex-1 break-all font-mono",children:(l=n.connection.Metadata)==null?void 0:l.Client})]}),e.jsxs("div",{className:"my-3 flex",children:[e.jsx("span",{className:"w-20 font-bold",children:t("info.source")}),e.jsx("span",{className:"font-mono",children:(a=n.connection.Metadata)==null?void 0:a.Source})]}),e.jsxs("div",{className:"my-3 flex",children:[e.jsx("span",{className:"w-20 font-bold",children:t("info.target")}),e.jsx("span",{className:"font-mono",children:(d=n.connection.Metadata)==null?void 0:d.Target})]}),e.jsxs("div",{className:"my-3 flex justify-between",children:[e.jsxs("div",{className:"flex flex-1",children:[e.jsx("span",{className:"w-20 font-bold",children:t("info.upload")}),e.jsx("span",{className:"font-mono",children:N(n.connection.Upload??0)})]}),e.jsxs("div",{className:"flex flex-1",children:[e.jsx("span",{className:"w-20 font-bold",children:t("info.download")}),e.jsx("span",{className:"font-mono",children:N(n.connection.Download??0)})]})]}),e.jsxs("div",{className:"my-3 flex",children:[e.jsx("span",{className:"w-20 font-bold",children:t("info.status")}),e.jsx("span",{className:"font-mono",children:n.connection.completed?e.jsx("span",{className:"text-red",children:t("info.closed")}):e.jsx("span",{className:"text-green",children:t("info.opening")})})]})]})}function on(n){const{translation:s}=D(),t=r.useMemo(()=>s("Connections").t,[s]),{className:o,style:c}=n,l=p("flex flex-wrap px-1",o);function a(d){var f;(f=n.onChange)==null||f.call(n,d)}return e.jsxs("div",{className:l,style:c,children:[e.jsx("div",{className:p("connections-types-item mb-2 pt-2",{selected:n.selected===""}),onClick:()=>a(""),children:t("filter.all")}),n.types.map(d=>e.jsxs("div",{className:p("connections-types-item mb-2 pt-2",{selected:n.selected===d.label}),onClick:()=>a(d.label),children:[d.label," (",d.number,")"]},d.label))]})}class cn{constructor(){this.connections=new Map,this.saveDisconnection=!1}appendToSet(s){var o;const t=s.reduce((c,l)=>c.set(l.ID,l),new Map);for(const c of this.connections.keys())if(!t.has(c))if(!this.saveDisconnection)this.connections.delete(c);else{const l=this.connections.get(c);l!=null&&this.connections.set(c,V(l,a=>{a.completed=!0,a.uploadSpeed=0,a.downloadSpeed=0}))}for(const c of t.keys()){if(!this.connections.has(c)){this.connections.set(c,{...t.get(c),uploadSpeed:0,downloadSpeed:0});continue}const l=this.connections.get(c),a=t.get(c);(o=this.connections)==null||o.set(c,{...a,uploadSpeed:a.Upload-l.Upload,downloadSpeed:a.Download-l.Download})}}toggleSave(){var s,t;if(this.saveDisconnection){this.saveDisconnection=!1;for(const o of this.connections.keys())(t=(s=this.connections)==null?void 0:s.get(o))!=null&&t.completed&&this.connections.delete(o)}else this.saveDisconnection=!0;return this.saveDisconnection}getConnections(){return[...this.connections.values()]}}function ln(){const n=r.useMemo(()=>new cn,[]),s=r.useRef(!0),[t,o]=r.useState([]),[c,l]=r.useState(!1),a=r.useCallback(function(f){n.appendToSet(f),s.current&&o(n.getConnections()),s.current=!s.current},[n]),d=r.useCallback(function(){const f=n.toggleSave();l(f),f||o(n.getConnections()),s.current=!0},[n]);return{connections:t,feed:a,toggleSave:d,save:c}}const m={Client:"client",Network:"network",Type:"type",Speed:"speed",Upload:"upload",Download:"download",Time:"time"},an=new Set([m.Client,m.Network,m.Type,m.Speed,m.Upload,m.Download,m.Time]);function rn(n,s){switch(!0){case(n===0&&s===0):return"-";case(n!==0&&s!==0):return`↑ ${N(n)}/s ↓ ${N(s)}/s`;case n!==0:return`↑ ${N(n)}/s`;default:return`↓ ${N(s)}/s`}}const L=ke();function dn(){const{translation:n,lang:s}=D(),t=r.useMemo(()=>n("Connections").t,[n]),o=Ke(),c=P(o),l=Ve(),a=r.useRef(null),[d,f]=ee({uploadTotal:0,downloadTotal:0}),{visible:y,show:j,hide:h}=Qe();function v(){l.closeAllConnections().finally(()=>h())}const{connections:b,feed:C,save:M,toggleSave:x}=ln(),k=r.useMemo(()=>b.map(i=>({id:i.ID,client:i.Metadata.Client,source:i.Metadata.Source,target:i.Metadata.Target,time:new Date(i.Start).getTime(),upload:i.Upload,download:i.Download,type:i.Metadata.Type,network:i.Metadata.Network.toUpperCase(),speed:{upload:i.uploadSpeed,download:i.downloadSpeed},completed:!!i.completed,original:i})),[b]),z=r.useMemo(()=>{const i=we(b,"Metadata.Type");return Object.keys(i).map(g=>({label:g,number:i[g].length})).sort((g,u)=>g.label.localeCompare(u.label))},[b]),$=r.useRef(null),O=Ne($,{threshold:[1]}),ie=r.useMemo(()=>[L.accessor(m.Client,{minSize:260,size:260,header:t(`columns.${m.Client}`)}),L.accessor(m.Network,{minSize:80,size:80,header:t(`columns.${m.Network}`)}),L.accessor(m.Type,{minSize:100,size:100,header:t(`columns.${m.Type}`),filterFn:"equals"}),L.accessor(i=>[i.speed.upload,i.speed.download],{id:m.Speed,header:t(`columns.${m.Speed}`),minSize:200,size:200,sortDescFirst:!0,sortingFn(i,g){var I,X;const u=((I=i.original)==null?void 0:I.speed)??{upload:0,download:0},w=((X=g.original)==null?void 0:X.speed)??{upload:0,download:0};return u.download===w.download?u.upload-w.upload:u.download-w.download},cell:i=>rn(i.getValue()[0],i.getValue()[1])}),L.accessor(m.Upload,{minSize:100,size:100,header:t(`columns.${m.Upload}`),cell:i=>N(i.getValue())}),L.accessor(m.Download,{minSize:100,size:100,header:t(`columns.${m.Download}`),cell:i=>N(i.getValue())}),L.accessor(m.Time,{minSize:120,size:120,header:t(`columns.${m.Time}`),cell:i=>tn(new Date(i.getValue()),s),sortingFn:(i,g)=>{var u,w;return(((u=g.original)==null?void 0:u.time)??0)-(((w=i.original)==null?void 0:w.time)??0)}})],[s,t]);r.useLayoutEffect(()=>{function i(g){for(const u of g)f({uploadTotal:u.UploadTotal,downloadTotal:u.DownloadTotal}),C(u.Connections)}return o==null||o.subscribe("data",i),()=>{o==null||o.unsubscribe("data",i)}},[o,C,f]),Ce(()=>{var i;(i=c.current)==null||i.destory()});const B=Se({data:k,columns:ie,getCoreRowModel:$e(),getSortedRowModel:Le(),getFilteredRowModel:Me(),initialState:{sorting:[{id:m.Time,desc:!1}]},columnResizeMode:"onChange",enableColumnResizing:!0}),J=B.getHeaderGroups()[0],[ae,re]=r.useState("");function de(i){var g;re(i),(g=B.getColumn(m.Type))==null||g.setFilterValue(i||void 0)}const[S,R]=ee({visible:!1,selectedID:"",connection:{}});function ue(){R(i=>{i.connection.completed=!0}),l.closeConnection(S.selectedID).finally(()=>h())}const T=P(S.connection);r.useEffect(()=>{var g;const i=(g=k.find(u=>u.id===S.selectedID))==null?void 0:g.original;i?R(u=>{u.connection={...i},S.selectedID===T.current.ID&&(u.connection.completed=T.current.completed)}):Object.keys(T.current).length!==0&&!T.current.completed&&R(u=>{u.connection.completed=!0})},[k,S.selectedID,T,R]);const Q=r.useMemo(()=>((O==null?void 0:O.intersectionRatio)??0)<1,[O]),fe=J.headers.map((i,g)=>{const u=i.column,w=u.id;return e.jsxs("th",{className:p("connections-th",{resizing:u.getIsResizing(),fixed:u.id===m.Client,shadow:Q&&u.id===m.Client}),style:{width:i.getSize()},ref:u.id===m.Client?$:void 0,children:[e.jsxs("div",{onClick:u.getToggleSortingHandler(),children:[Z(i.column.columnDef.header,i.getContext()),u.getIsSorted()!==!1?u.getIsSorted()==="desc"?" ↓":" ↑":null]}),g!==J.headers.length-1&&e.jsx("div",{onMouseDown:i.getResizeHandler(),onTouchStart:i.getResizeHandler(),className:"connections-resizer"})]},w)}),me=B.getRowModel().rows.map(i=>{var g;return e.jsx("tr",{className:"cursor-default select-none",onClick:()=>{var u;return R({visible:!0,selectedID:(u=i.original)==null?void 0:u.id})},children:i.getAllCells().map(u=>{var I;const w=p("connections-block",{"text-center":an.has(u.column.id),completed:(I=i.original)==null?void 0:I.completed},{fixed:u.column.id===m.Client,shadow:Q&&u.column.id===m.Client});return e.jsx("td",{className:w,style:{width:u.column.getSize()},children:Z(u.column.columnDef.cell,u.getContext())},u.column.id)})},(g=i.original)==null?void 0:g.id)});return e.jsxs("div",{className:"page !h-100vh",children:[e.jsxs(te,{title:t("title"),children:[e.jsx("span",{className:"connections-filter flex-1 cursor-default",children:`(${t("total.text")}: ${t("total.upload")} ${N(d.uploadTotal)} ${t("total.download")} ${N(d.downloadTotal)})`}),e.jsx(Xe,{className:"connections-filter",checked:M,onChange:x,children:t("keepClosed")}),e.jsx(A,{className:"connections-filter dangerous",onClick:j,type:"close-all",size:20})]}),z.length>1&&e.jsx(on,{types:z,selected:ae,onChange:de}),e.jsx(Y,{ref:a,className:"connections-card relative",children:e.jsx("div",{className:"min-h-full min-w-full overflow-auto",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsx("tr",{className:"connections-header",children:fe})}),e.jsx("tbody",{children:me})]})})}),e.jsx(Je,{title:t("closeAll.title"),show:y,onClose:h,onOk:v,children:t("closeAll.content")}),e.jsxs(nn,{containerRef:a,bodyClassName:"flex flex-col",visible:S.visible,width:450,children:[e.jsxs("div",{className:"h-8 flex items-center justify-between",children:[e.jsx("span",{className:"pl-3 font-bold",children:t("info.title")}),e.jsx(A,{type:"close",size:16,className:"cursor-pointer",onClick:()=>R("visible",!1)})]}),e.jsx(sn,{className:"mt-3 px-5",connection:S.connection}),e.jsx("div",{className:"mt-3 flex justify-end pr-3",children:e.jsx(F,{type:"danger",disabled:S.connection.completed,onClick:()=>ue(),children:t("info.closeConnection")})})]})]})}const un=[{label:"Default",value:""},{label:"Debug",value:"debug"},{label:"Info",value:"info"},{label:"Warn",value:"warning"},{label:"Error",value:"error"}],fn=new Map([["debug","text-teal-500"],["info","text-sky-500"],["warning","text-pink-500"],["error","text-rose-500"]]);function mn(){var j;const n=r.useRef(null),s=r.useRef([]),[t,o]=r.useState([]),{translation:c}=D(),{data:{logLevel:l},set:a}=ce(),{t:d}=c("Logs"),f=le(),y=r.useRef(((j=n.current)==null?void 0:j.scrollHeight)??0);return r.useLayoutEffect(()=>{const h=n.current;h!=null&&y.current===h.scrollTop+h.clientHeight&&(h.scrollTop=h.scrollHeight-h.clientHeight),y.current=(h==null?void 0:h.scrollHeight)??0}),r.useEffect(()=>{function h(v){s.current=s.current.slice().concat(v.map(b=>({...b,Time:new Date}))),o(s.current)}return f!=null&&(f.subscribe("data",h),s.current=f.buffer(),o(s.current)),()=>f==null?void 0:f.unsubscribe("data",h)},[f]),e.jsxs("div",{className:"page",children:[e.jsxs(te,{title:d("title"),children:[e.jsxs("span",{className:"mr-2 text-sm text-primary-darken",children:[d("levelLabel"),":"]}),e.jsx(Ye,{disabled:!1,options:un,value:l,onSelect:h=>a(v=>{v.logLevel=h})})]}),e.jsx(Y,{className:"mt-2.5 flex flex-1 flex-col md:mt-4",children:e.jsx("ul",{className:"logs-panel",ref:n,children:t.map((h,v)=>e.jsxs("li",{className:"inline-block text-[11px] leading-5",children:[e.jsxs("span",{className:"mr-2 text-orange-400",children:["[",U(h.Time).format("YYYY-MM-DD HH:mm:ss"),"]"]}),e.jsxs("span",{className:fn.get(h.Type),children:["[",h.Type.toUpperCase(),"]"]}),e.jsxs("span",{children:[" ",h.Payload]})]},v))})})]})}function hn(n){const{routes:s}=n,{translation:t}=D(),{t:o}=t("SideBar"),c=W(),l=s.map(({path:a,name:d,noMobile:f})=>e.jsx("li",{className:p("item",{"no-mobile":f}),children:e.jsx(Re,{to:{pathname:a,search:c.search},className:({isActive:y})=>p({active:y}),children:o(d)})},d));return e.jsx("div",{className:"sidebar",children:e.jsx("ul",{className:"sidebar-menu",children:l})})}function pn(){le();const n=W(),s=[{path:"/logs",name:"Logs",element:e.jsx(mn,{}),noMobile:!0},{path:"/connections",name:"Connections",element:e.jsx(dn,{}),noMobile:!0}],t=e.jsxs("div",{className:p("app"),children:[e.jsx(hn,{routes:s}),e.jsx("div",{className:"page-container",children:e.jsx(De,{})})]});return e.jsx(Te,{children:e.jsxs(H,{path:"/",element:t,children:[e.jsx(H,{path:"/",element:e.jsx(Ie,{to:{pathname:"/connections",search:n.search},replace:!0})}),s.map(o=>e.jsx(H,{path:o.path,element:o.element},o.path))]})})}function xn(){const n=document.getElementById("root"),s=e.jsx(r.StrictMode,{children:e.jsx(ze,{children:e.jsx(r.Suspense,{fallback:e.jsx(en,{visible:!0}),children:e.jsx(pn,{})})})});Ee(n).render(s)}xn();
